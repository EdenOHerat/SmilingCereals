<!DOCTYPE html>

<html>
	<head>
		<title th:text="${cereal.name}">Cereal name</title>
		<link rel="stylesheet" th:href="@{/css/navbar.css}">
	</head>
	
	<body>
		<div th:replace="fragments/navbar :: navbar"></div>
		<h1>SMILING CEREALS</h1>
		<h2 th:text="${cereal.name}">Cereal name</h2>
		<p th:text="${cereal.description}">Cereal description</p>
		<p th:text="'Flavor: ' + ${cereal.flavor}"></p>
		<div>
			<img th:src="@{'/images/cereals/' + ${cereal.fileName}}" height="400px" width="320px" />
		</div>
		<span th:text="|Smiles for ${cereal.name}: ${cereal.avgSmiles}|">Smiles</span>
		
		<div th:if="${#lists.isEmpty(cereal.reviews)}">No reviews yet</div>
		<section th:if="${!#lists.isEmpty(cereal.reviews)}">
			<div> 
				<span>Reviews</span>
				<ul>
					<li th:each="item : ${cereal.reviews}">
						<span th:text="${item.title}">Title</span>
						<span th:text="|Smiles: ${item.rating}|">5</span>
						<div th:text="${item.body}">Review</div>
						<span th:text="|Posted by ${item.user.name} ${item.user.surname}|"></span>
					</li>
				</ul>
			</div>
		</section>
		
		<section>
			<span>Post a review</span>
			<form th:action="@{/cereals/{id}/newReview(id=${cereal.id})}"
					th:object="${newReview}" method="post">
				<label> Title
					<input type="text" required th:field="${newReview.title}">
				</label>
				<label> Review
					<textarea th:field="${newReview.body}" rows="3">
						Write down your review
					</textarea>
				</label>
				<label>
				    Smiles:
				    <span id="ratingValue"
				          th:text="${newReview.rating != null ? newReview.rating : 2.5}">
				        2.5
				    </span>

				    <input type="range"
				           min="0"
				           max="5"
				           step="0.5"
				           th:field="${newReview.rating}"
				           oninput="document.getElementById('ratingValue').textContent = this.value">
				</label>
				<button>Post</button>
			</form>
		</section>
		
		<a th:ref="@{/cereals}"> Back to all cereals</a>
	</body>
</html>